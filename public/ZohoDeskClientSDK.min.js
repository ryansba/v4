!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ZOHODESK=t():e.ZOHODESK=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){n(1);let r=n(2);e.exports=r.default||r},function(e,t){var n=function(e){var t,n=i();function r(){}function i(e){var t={},n=e||window.location.href;return n.substr(n.indexOf("?")+1).split("&").forEach((function(e){var n=e.split("=");t[n[0]]=n[1]})),t.hasOwnProperty("serviceOrigin")&&(t.serviceOrigin=decodeURIComponent(t.serviceOrigin)),t}return r.prototype.Info=function(){(e.isDevMode()||e.isLogEnabled())&&console.info.apply(console,arguments)},r.prototype.Error=console.error,e.GetQueryParams=i,e.isDevMode=function(){return n&&n.isDevMode},e.isLogEnabled=function(){return n&&n.isLogEnabled},e.getLogger=function(){return t&&t instanceof r||(t=new r),t},e}(window.ZSDKUtil||{}),r=function(e){var t,r,i,o=n.getLogger(),s=100,a={},u=n.GetQueryParams();function c(e){var n;try{n="string"==typeof e.data?JSON.parse(e.data):e.data}catch(t){n=e.data}var s,c,l,v,g,_,h,E=n.type;try{if("__REGISTER__"===E||(_=(g=e).source,h=g.origin,t.isRegistered()&&r===_&&i===h||new Error("Un-Authorized Message.")))switch(E){case"__REGISTER__":!function(e,n){r=window.parent,i=u.serviceOrigin;var o=window.location.origin;t.dcType=o.split(".").pop().toUpperCase(),"COM"==t.dcType&&(t.dcType="US");t.key=n.uniqueID,t.parentWindow=r,t._isRegistered=!0,f({type:"__REGISTER__",widgetOrigin:y(),uniqueID:t.key},t);var s=n.data;p(t,"Load",s)}(0,n);break;case"__EVENT_RESPONSE__":c=(s=n).promiseID,l=s.data,v=s.isSuccess,a.hasOwnProperty(c)&&(v?a[c].resolve(l):a[c].reject(l),a[c]=void 0,delete a[c]);break;default:!function(e,n){var r,i=n.widgetID,o=n.eventName;if(t.key===i)r=p(t,o,n.data);else{var s=t._childWidgets[i];s&&(r=p(s,o,n.data))}if(n.isPromise){var a={};Promise.all(r).then((function(e){a.response=e,a.widgetID=i,a.sourceWidgetID=t.key,d(n,a)})).catch((function(e){a.response=e,a.widgetID=i,a.sourceWidgetID=t.key,d(n,a)}))}}(0,n)}}catch(e){o.Error("[SDK.MessageHandler] => ",e.stack)}}function d(e,n){f({type:"__EVENT_RESPONSE__",widgetOrigin:y(),uniqueID:t.key,eventName:e.eventName,data:n,promiseID:e.promiseID},t)}function p(e,t,n){var r=e.eventHandlers[t],i=[];if(Array.isArray(r))for(var o=0;o<r.length;o++){var s,a;try{a=(s=r[o].call(e,n))instanceof Promise?s.then((function(e){return{isSuccess:!0,response:e}})).catch((function(e){return{isSuccess:!1,response:e}})):{isSuccess:!0,response:s}}catch(e){a={isSuccess:!1,response:e}}i.push(a)}return i}function f(e,t){var n,r,i=e.isPromise;if(i&&(n="Promise"+s++,e.promiseID=n),t&&(e.uniqueID=(t.parentWidget||t).key,e.widgetID=t.key),e.time=(new Date).getTime(),v(e),i)return r=n,new Promise((function(e,t){a[r]={resolve:e,reject:t,time:(new Date).getTime()}}))}function l(){v({type:"__DEREGISTER__",uniqueID:t.key})}function v(e){if("object"==typeof e&&(e.widgetOrigin=encodeURIComponent(y())),!r)throw new Error("Parentwindow reference not found.");r.postMessage(e,u.serviceOrigin)}function y(){return window.location.protocol+"//"+window.location.host+window.location.pathname}return e.Init=function(e){t=e,window.addEventListener("message",c),window.addEventListener("unload",l)},e.SendEvent=f,e}(window.ZSDKMessageManager||{});window.ZSDK=function(){var e,t=n.GetQueryParams();function i(e){this.serviceOrigin=e.serviceOrigin||t.serviceOrigin,this.parentWidget=e.parentWidget,this.key=e.key,this._isRegistered=!1,this._childWidgets={},this.eventHandlers=Object.create(null),this.meta}return i.prototype.on=function(e,t){if("string"!=typeof e)throw new Error("Invalid eventname parameter passed.");if("function"!=typeof t)throw new Error("Invalid function parameter passed.");var n=this.eventHandlers[e];if(Array.isArray(n)||(this.eventHandlers[e]=n=[]),n.push(t),"Load"!==e){var i={type:"__EVENT_BIND__",eventName:e,count:n.length};this.parentWidget&&!this.parentWidget.isRegistered()||!this.parentWidget&&!this.isRegistered()?(this.parentWidget||this).on("Load",(function(){r.SendEvent(i,this)})):r.SendEvent(i,this)}},i.prototype._sendEvent=function(e,t,n){var i={type:"__EVENT__",eventName:e,data:t,isPromise:n};return r.SendEvent(i,this)},i.prototype.emit=function(e,t){var n={type:"__EMIT__",eventName:e,data:t};r.SendEvent(n,this)},i.prototype.isRegistered=function(){return this._isRegistered},i.prototype.fetch=function(e){var t={eventName:"__HTTP__",isPromise:!0,options:e};return r.SendEvent(t,this)},i.prototype.createInstance=function(e){var t={eventName:"__CREATE_INSTANCE__",isPromise:!0,options:e};return r.SendEvent(t,this)},i.prototype.modal=function(e){return"object"==typeof e&&(e.location="__MODAL__"),this.createInstance(e)},i.prototype.getWidgets=function(){return r.SendEvent({eventName:"__WIDGETS_INFO__",isPromise:!0},this)},i.prototype.getWidgetInstance=function(e){if("string"!=typeof e)throw new Error("Invalid WidgetID passed");if(this.parentWidget)return this.parentWidget.getWidgetInstance(e);var t=this._childWidgets[e];return t||(this._childWidgets[e]=t=new i({key:e,parentWidget:this})),t},i.prototype.getFileObject=function(e){return new File([e.slice(0,e.size)],e.name,{type:e.type})},{Init:function(){return e||(e=new i({serviceOrigin:t.serviceOrigin}),r.Init(e),e)},_getRootInstance:function(){return e}}}()},function(e,t,n){"use strict";n.r(t);let r=ZSDK.Init();const i=e=>{let t=e.file;return new Promise((n,r)=>{let i=new FileReader;i.readAsArrayBuffer(t),i.onload=r=>{n({fileName:t.name,fileType:t.type,content:i.result,key:e.key})}})};const o="DESK_EVENT";let s={notify:function(e){return r._sendEvent(o,{type:"NOTIFY",value:e},!0)},showpopup:function(e){return r._sendEvent(o,{type:"POPUP",value:e},!0)}};var a;t.default=Object.assign({},(a=o,{extension:{onload:()=>new Promise(e=>{r.on("Load",t=>{t.instance=r,e(t)})})},request:e=>{if(e.hasOwnProperty("fileObj")){let{fileObj:t}=e;return new Promise(n=>{let o=[];for(let e of t)e.file instanceof File&&o.push(i(e));Promise.all(o).then(t=>{e.fileObj=t,n(r.fetch(e))})})}return r.fetch(e)},get:(e,t)=>r._sendEvent(a,{type:"GET_DATA",property:e,value:t},!0),set:(e,t)=>r._sendEvent(a,{type:"SET_DATA",property:e,value:t},!0),delete:(e,t)=>r._sendEvent(a,{type:"DELETE_DATA",property:e,value:t},!0),invoke:(e,t,n)=>{var i;return"RESIZE"==e&&(t=t||{height:document.documentElement.offsetHeight,width:document.documentElement.offsetWidth}),i={type:e,property:t,value:n},r._sendEvent(a,i,!0)},log:function(e){return r._sendEvent(a,{type:"LOG",value:e},!0)}}),s)}])}));
